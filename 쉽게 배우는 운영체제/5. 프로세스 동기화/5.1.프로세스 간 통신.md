# 5.1. 프로세스 간 통신

## 프로세스 간 통신이란?

- 프로세스 간 통신: IPC(Inter Process Communication)
- 운영체제가 프로세스끼리 쉽게 데이터를 주고 받을 수 있게 제공하는 통신 방법
- 공유 메모리나 공유 파일을 이용한 통신, 파이프를 이용한 통신, 소켓을 이용한 통신이 있다.

## 프로세스 간 통신의 분류

### 통신 방향에 따른 분류

- 양방향 통신: 소켓
- 반양방향 통신 (무전기 같은)
- 단방향 통신: 공유 메모리나 공유 파일, 파이프

### 통신 구현 방식에 따른 분류

바쁜 대기 문제를 해결하는 방법으로 동기화를 사용하는데, 이 동기화의 유무로 통신 구현 방식을 분류한다.

> 바쁜 대기(busy wait)
> 상태가 변경됨을 확인하기 위해 반복문을 무한 실행하며 기다리는 것

- 대기가 있는 통신(blocking communication)
  - 동기화 통신(synchronous communication)
  - 동기화를 지원하는 방식으로, 데이터를 받는 쪽은 데이터가 도착할 때까지 자동으로 대기 상태에 머물러 있다.
  - 파이프, 소켓
- 대기가 없는 통신(non-blocking communication)
  - 비동기화 통신(asynchronous communication)
  - 동기화를 지원하지 않으므로, 데이터를 받는 쪽은 바쁜 대기를 사용하여 데이터가 도착했는지 직접 확인한다.
  - 공유 메모리나 공유 파일

## 프로세스 간 통신의 종류

### 공유 메모리나 공유 파일을 이용한 통신

- 일정한 메모리 영역이나 파일을 공유하고 이를 통해 데이터를 주고 받음
- 프로세스끼리 알아서 데이터를 주고 받는 방법을 결정해야 하는 가장 원시적인 방법
- 방법
  - open()
    - 사용하고자 하는 파일이 있는지, 쓰기 권한이 있는지 확인할 수 있다.
    - 사용 가능할 경우 fd(파일 기술자, file descriptor)를 반환한다. 파일을 연 다음에는 fd를 통해서만 파일에 접근할 수 있다.
  - read(), write() : 읽기, 쓰기
  - close(): 닫기
- 운영체제 입장에서는 저장장치의 데이터를 읽고 쓰는 것도 일반 프로세스와 입출력 프로세스 간의 통신이다.
- 운영체제에서 프로세스 동기화를 제공하지 않기 때문에 프로세스가 알아서 동기화를 해야 한다.
  - 주로 부모 프로세스가 wait() 함수를 이용하여 자식 프로세스의 작업이 끝날 때까지 기다렸다가 작업을 시작한다.

### 파이프를 이용한 통신

- 파일 입출력과 같이 open() 함수로 기술잘를 얻어 작업한 후 close() 핫무로 마무리 한다.
- 단방향 통신으로, 양방향 통신을 하기 위해서는 2개의 파이프가 필요하다.
  - 운영체제에서 동기화 통신을 제공하므로, 각각의 프로세스가 동일한 자원에 접근할 때 하나의 프로세스가 해당 자원에 대한 연산을 수행 중이면 다른 프로세스는 대기 상태가 된다. 작업이 완료되면 자동으로 대기 상태가 풀려 동기화가 이뤄진다.
- 종류
  - 이름 없는 파이프(anonymous pipe)
    - 일반적인 파이프
    - 부모와 자식 혹은 같은 붐모를 가진 자식 프로세스와 같이 서로 관련 있는 프로세스 간 통신에 사용
  - 이름 있는 파이프(named pipe)
    - FIFO라 불리는 특수 파일을 이용하여 서로 관련 없는 프로세스 간 통신에 사용

### 소켓(socket)을 이용한 통신

- 컴퓨터와 컴퓨터가 네트워크로 연결된 경우의 통신에 주로 사용되는 수단
- 소켓 프로그래밍은 곧 네트워크 프로그래밍을 말한다.
  - 네트워크에서 데이터를 내보내는 행위는 클라이언트 소켓이 서버 소켓에 데이터를 보내는 것이기 때문
  - 하나의 서버(포트)에 여러 클라이언트가 접근하는데, 여러 클라이언트를 연결하기 위해서는 멀티탭 역할을 하는 소켓이 필요하다.
- 원격 프로시저 호출
  - 다른 컴퓨터에 있는 함수를 호출하는 것으로, 소켓을 이용하여 구현한다.
  - 통신하고자하는 다른 컴퓨터의 위치를 파악하고 -> 어떤 프로세스와 통신할 지 결정하고 -> 통신한다.

#### 용어

- 포트(Port)
  - TCP가 네트워크를 사용하는 프로세스들을 구분하기 위해 붙인 번호
  - 데이터가 전달될 때 IP 주소에 해당하는 컴퓨터로 보내지는데, 이 컴퓨터에는 네트워크를 사용하는 다양한 프로세스들이 존재하기 때문에 포트 번호가 필요하다.
  - 즉, 어떤 프로세스와 통신할지 결정하는 데 필요한 번호
  - 네트워크를 사용하는 프로세스가 생성되면 운영체제로부터 0~65535 사이의 포트 번호를 부여받는다.
  - 예: 웹 데몬(HTTPD, Hyper Text Transfer Protocol Daemon)은 80번, 파일 데몬(FTPD, File Transfer Protocol Daemon)은 21번
- IP(Internet Protocal): 데이터를 전송하는 목적지이자 주소
- 데몬(Daemon): 서버에서 돌아가는 프로세스
