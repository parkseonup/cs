# 17. 캐시 메모리

CPU가 메모리에 접근하는 시간은 CPU가 연산하는 속도보다 느리다.

## 캐시 메모리란?

- CPU와 메모리 사이에 위치한, 레지스터보다 용량이 크고 메모리보다 빠른 SRAM 기반의 저장 장치
- CPU의 연산 속도와 메모리 접근 속도의 차이를 조금이나마 줄이기 위해 탄생
- CPU가 자주 사용할 법한 데이터를 예측하여 RAM에서 가지고와 캐시 메모리에 저장한다.
  - 예측이 들어맞을 경우: 캐시 히트 -> CPU가 메모리에 접근하지 않고 캐시에서 접근함
  - 예측이 틀렸을 경우: 캐시 미스 -> CPU가 메모리에 접근해야 함

## 캐시 메모리의 구조

캐시 메모리는 계층적 캐시 메모리로 구현되어 있다. (L1-L2-L3)

- L1은 CPU의 레지스터와 가장 가까운 곳에 위치하고, 레지스터보다는 용량이 크지만 L2보다는 용량이 작다. 하지만 캐시 메모리 중 가장 빠르다.
- L2 캐시는 L3보다 용량이 작지만, L3보다 빠르다.
- 일반적으로 L1, L2 캐시는 CPU의 코어 내부에, L3 캐시는 코어 외부에 위치한다.
- L3 캐시는 RAM보다 작지만, RAM보다 빠르다.

### 멀티코어 프로세서의 경우

- L1, L2는 코어 내부에 있으므로, 각각의 코어마다 다른 데이터를 저장하고 있을 수 있다.
- L3는 코어 외부에 있으므로 코어들의 데이터를 공유하는 형태로 사용될 수 있다.

### 분리형 캐시의 경우

L1 캐시가 명령어만을 담고 있는 L1I 캐시와 데이터만을 담고 있는 L1D 캐시로 나누어 관리함

## 메모리 계층 구조

레지스터 -> 캐시 메모리(L1 캐시 -> L2 캐시 -> L3 캐시) -> 메인 기억장치 -> 보조 기억장치

## 참조 지역성의 원리

- CPU가 사용할 법한 데이터를 예측하는 방법
- CPU가 메모리에 접근할 때 주된 경향을 바탕으로 만들어진 원리
  - CPU는 최근에 접근했던 메모리 공간에 다시 접근하려는 경향이 있다. (시간 지역성)
  - CPU는 접근한 메모리 공간 근처를 접근하려는 경향이 있다. (공간 지역성)
