# 26. 프로세스 개요

- 실행 중인 프로그램

## 프로세스 종류

### 포그라운드 프로세스(foreground process)

- 사용자가 볼 수 있는 공간에서 실행되는 프로세스
- 웹 브라우저, 메모장, 게임 등

### 백그라운드 프로세스(background process)

- 사용자가 볼 수 없는 공간에서 실행되는 프로세스
- 종류
  - 사용자와 직접 상호작용이 가능한 프로세스
  - 데몬(daemon) === 서비스(service): 사용자와 상호작용하지 않고 그저 정해진 일만 수행하는 프로세스

## PCB(프로세스 제어 블록)

- 운영체제가 빠르게 번갈아가며 수행되는 프로세스들을 관리하기 위해 사용하는 자료구조
  - 모든 프로세스는 실행을 위해 CPU가 필요하다. 하지만 CPU는 한정돼있기 때문에, 프로세스들은 돌아가며 한정된 시간 만큼만 CPU를 이용하게 된다.
    - 자신의 차례에 정해진 시간만큼 CPU 이용
    - 타이머 인터럽트가 발생하면 차례를 양보함
- 프로세스 관련 정보를 저장하는 자료 구조
- 마치 상품(프로세스)에 달린 상품 태그 같은 역할을 한다.
- 프로세스 생성 시 커널 영역에 생성되며, 종료시 폐기된다.

### PCB에 담기는 정보

운영체제마다 차이가 있으나, 대표적으로 담기는 정보는 아래와 같다.

- PID
  - 프로세스 ID
  - 특정 프로세스를 식별하기 위해 부여되는 고유한 번호
- 레지스터 값
  - 프로그램 카운터, 스택 포인터 등
  - 프로세스의 실행이 재게될 때 이전까지 사용한 레지스터 중간 값을 모두 복원하기 위해 저장되는 정보
    - 프로세스는 타이머 인터럽트가 발생되면 차례를 넘기고, 차례가 돌아왔을 때 다시 실행을 재게한다. 이때 이전 실행에서 사용했던 데이터들을 알아야 하기 때문에 레지스터 값을 저장한다.
- 프로세스 상태
  - 입출력 장치를 사용하기 위해 기다리는 상태, CPU를 사용하기 위해 기다리는 상태, CPU를 이용 중인 상태 등
- CPU 스케줄링 정보
  - 프로세스가 언제, 어떤 순서로 CPU를 할당 받아서 사용하게 될 지에 대한 정보
- 메모리 정보
  - 프로세스가 어느 주소에 저장되어 있는지에 대한 정보
  - 페이지 테이블 정보
- 사용한 파일과 입출력장치 정보
  - 할당된 입출력장치, 사용 중인(열린) 파일 정보

## 문맥 교환(Context Switch)

### 문맥이란?

- 프로그램 카운터 등 각종 레지스터 값, 메모리 정보, 열었던 파일, 사용한 입출력장치 등 기존에 실행되던 프로세스가 지금까지의 중간 정보를 백업하는데, 이 중간 정보를 문맥(Context)이라고 한다.
- 다음 차례가 왔을 때 실행을 재개하기 위한 정보이다.
- 실행 문맥을 백업해두면 언제든 해당 프로세스의 실행을 재개할 수 있다.

### 문맥 교환이란?

- 기존의 실행 중인 프로세스의 문맥을 백업하고 새로운 프로세스 실행을 위해 문맥을 복구하는 과정
- 실행 중인 프로세스가 교체될 때, 교체 전에 문맥 교환이 일어난다.

## 프로세스의 메모리 영역 (사용자 영역)

### 프로세스의 사용자 영역에 저장되는 것

1. 코드(텍스트) 영역
   - 실행할 수 있는 코드. 기계어로 이루어진 명령어가 저장되는 공간
   - 데이터가 아닌 CPU가 실행할 명령어가 저장되므로, 쓰기가 금지된 readonly 영역이다.
2. 데이터 영역
   - 잠깐 썼다가 없앨 데이터가 아닌 프로그램이 실행되는 동안 유지할 데이터가 저장되는 영역 (ex. 전역 변수)
3. 힙 영역
   - 개발자가 직접 할당할 수 있는 저장 공간
4. 스택 영역
   - 데이터가 일시적으로 저장되는 공간
   - 데이터 영역에 담기는 값과는 달리 잠시 쓰다가 제거될 값이 저장되는 공간 (ex. 매개 변수, 지역 변수)
5. 기타

- 코드 영역과 데이터 영역은 변경되지 않는 값을 저장하기 때문에 영역의 크기는 불변한다. 이러한 두 영역을 정적 할당 영역이라고 한다.
- 힙 영역과 스택 영역은 변경될 값을 저장하기 때문에 영역의 크기가 가변적이다. 이러한 두 영역을 동적 할당 영역이라고 한다.
  - 두 영역의 크기가 가변적이기 때문에, 두 영역의 주소가 가까우면 영역의 크기가 커질 경우 주소가 겹치는 충돌이 일어날 수 있다.
  - 때문에 일반적으로 힙 영역은 낮은 주소에서 높은 주소로 할당이 되고, 스택은 높은 주소에서 높은 주소에서 낮은 주소로 할당이 된다.
